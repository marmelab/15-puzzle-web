{% extends "base.html.twig" %}

{% block refresh %}
  {% if not winner %}
    <meta http-equiv="refresh" content="3">
  {% endif %}
{% endblock %}

{% block header %}
  <div class="section">
    <div class="row">
      <div class="col s12">
        {% if winner %}
          {% if winner.id == player.id %}
            <h5>Congratulations, you have solved the puzzle in {{ winner.turn }} turns!</h5>
          {% else %}
            <h5>The puzzle has been solved in {{ winner.turn }} turns!</h5>
          {% endif %}
        {% elseif otherPlayer %}
          <h5>The game is running</h5>
        {% else %}
          <h5>Waiting for the second player...</h5>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}

{% block content %}
  <div class="section">
    {% if player and otherPlayer %}
      <div class="row">
        {% if isOwner %}
          <div class="col s6">
            <h5>You: turn {{ player.turn }}</h5>
          </div>
          <div class="col s6">
            <h5>Your opponent: turn {{ otherPlayer.turn }}</h5>
          </div>
        {% else %}
          <div class="col s6">
            <h5>Player 1: turn {{ player.turn }}</h5>
          </div>
          <div class="col s6">
            <h5>Player 2: turn {{ otherPlayer.turn }}</h5>
          </div>
        {% endif %}
      </div>
      <div class="row">
        <div class="col s6">
          {% include 'grid.html.twig' with {'game': game, 'player': player, 'readOnly': winner or not isOwner} %}
        </div>
        <div class="col s6">
          {% include 'grid.html.twig' with {'game': game, 'player': otherPlayer, 'readOnly': true} %}
        </div>
      </div>
    {% else %}
      <div class="row">
        <div class="col s12">
          {% include 'grid.html.twig' with {'game': game, 'player': player, 'readOnly': true} %}
        </div>
      </div>
      {% if isOwner %}
        <div class="row">
          <div class="col s12">
            <h5>Invite a friend by sending him this url</h5>
          </div>
          <div class="col s12">
            {% include 'share_url.html.twig' with {'url': app.request.uri } %}
          </div>
        </div>
      {% else %}
        <div class="row">
          <div class="col s12">
            <a class="btn blue" href="{{ path('game_join', {'id': game.id}) }}"><i class="material-icons left">add_circle_outline</i>Join this game</a>
          </div>
        </div>
      {% endif %}
    {% endif %}
  </div>
{% endblock %}
